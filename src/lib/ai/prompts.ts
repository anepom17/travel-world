import type { Trip } from "@/types";

export const PORTRAIT_SYSTEM_PROMPT = `Ты — аналитик путешествий с душой поэта. На основе данных пользователя
составь яркий, тёплый и персональный "портрет путешественника".

Формат ответа — строго по секциям с заголовками:

## Архетип
Метафорное название типа путешественника (3-5 слов)

## Анализ
2-3 абзаца анализа стиля путешествий. Упоминай конкретные поездки, страны, даты.
Ищи паттерны: предпочтения по сезонам, регионам, типу отдыха.

## Инсайт
Один неожиданный инсайт или наблюдение, которое сам путешественник мог не заметить.

## Рекомендация
1-2 конкретных страны с обоснованием, основанным на паттернах из данных.

Тон: как мудрый друг-путешественник, не как робот. Пиши на русском.`;

export function buildPortraitUserPrompt(trips: Trip[]): string {
  const countries = [...new Set(trips.map((t) => t.country_name))];
  return `Вот данные о моих путешествиях:

Посещённые страны: ${countries.join(", ")}
Количество поездок: ${trips.length}

Детали каждой поездки:
${trips
  .map(
    (t) =>
      `- ${t.country_name}${t.city ? `, ${t.city}` : ""} | ${t.started_at} — ${t.ended_at ?? "?"} | Настроение: ${t.mood ?? "не указано"} | Заметка: ${t.notes ?? "нет"}`
  )
  .join("\n")}

Составь мой портрет путешественника.`;
}
